---
import { getCollection } from 'astro:content';

const releases = await getCollection('releases');
const artists = await getCollection('artists');
---

<html>
  <head><title>Releases</title></head>
  <body>
    <h1>Releases</h1>
    <ul>
      {releases.map(release => {
        const artist = artists.find(a => a.id === release.data.artist);
        return (
          <li>
            <a href={`/releases/${release.id}`}>
              <img src={release.data.cover} alt={release.data.title} width="100" />
              {release.data.title} by {artist?.data.name}
            </a>
          </li>
        );
      })}
    </ul>
  </body>
</html>
